<app-main-navbar></app-main-navbar>

<h3 style="text-align: center;" *ngIf="isOnlyAttendee"> Recently Visited </h3> 

<div class="dashboard-responsive-margin">
    <div class="container">
        <div class="col-sm-12 col-md-10 col-lg-8 col-xs-12">
            <!----------------------- school sorting ----------------->
            <div class="row" style="display: none;">
                <div class="col-sm-12" style="margin-bottom:5px;">
                    <div class="dropdown-display-desktop pull-right" *ngIf="sort_story_school_array?.length>0" style="margin-right:-20px;">
                        <div class="dropdown open">
                            <button style="border:0;" id="stories_sort_type_button" (click)="openSortTypeDropdown()" class="btn-default dropdown-toggle" type="button" data-toggle="dropdown"> Sort latest activity by:
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" id="stories_sort_type" style="display:none;">
                                <li class="dropdown-submenu" *ngFor="let  school of sort_story_school_array;" [ngClass]="school.id==selected_school_id ? 'active-element' : ''">
                                    <a class="test" (click)="selectSortTypeSchool(school.id, school.display_id)">{{school.name | slice:0:15}} <span style="padding-top:3px;" class="fa fa-caret-right pull-right"></span></a>
                                    <ul class="dropdown-menu" [id]="school.display_id" style="display:none">
                                        <li *ngFor="let sort_type of school.story_type" (click)="selectStoryType(school.id, sort_type.type, school.name)" [ngClass]="sort_type.type==story_type_display ? 'active-element' : ''"><a>{{sort_type.display}}</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!----------------------- school sorting end -------------------->
            
            <!------------------------- Conversation part ------------------------->
            <div class="row"  style="display:none;"> 
                <div class="dasboard-stories-card" *ngIf="conversation_school_list_array?.length>0">
                    <div class="custom-profile-image" *ngFor="let user of user_child_detail_array;let x=index;">
                        <ng-container *ngIf="user.user_type == 'parent' && x==0">
                            <span *ngIf="user.staticDpImg"><img [src]="user.staticDpImg" (error)="updateDefaultImageUrl($event)" class="img-circle" /></span>
                            <div *ngIf="!user.staticDpImg" class="custom-profile-image-text uppercase" >{{user.firstName | slice:0:1}}{{user.lastName | slice:0:1}} </div>
                        </ng-container>
                    </div>
                    <div class="stories-card">
                        <div class="col-sm-12 well main-form">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="conversation-header">
                                        <div class="flex-content">
                                            <div class="sub-head pull-left" style="padding-top:5px;"> <i class="fa fa-comments"></i>&nbsp;<span class="hide-conver-mobile">CONVERSATION</span> </div>
                                            <select class="select-school pull-right" [(ngModel)]="conversation_selected_school_id" [disabled]="conversation_disabled_status" (ngModelChange)="onChangeSelectConversationSchool($event)" name="conversation_school_name">
                                                <option [value]="school.id" *ngFor="let school of conversation_school_list_array">{{school.name}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="school-select-clear" *ngIf="conversation_disabled_status" (click)="clearConversationDisabledAttribute()">Clear <i class="fa fa-times" aria-hidden="true"></i></div>

                                    <div class="body-content-conversation">
                                        <div class="select-user">
                                            <ng-select
                                                [items]="conversation_users_array"
                                                [multiple]="true"
                                                bindLabel="name"
                                                groupBy="sort_type"
                                                [closeOnSelect]="false"
                                                bindValue="id"
                                                [virtualScroll]="true"
                                                [selectableGroup]="true"
                                                [selectableGroupAsModel]="true"
                                                [excludeGroupsFromDefaultSelection]="true"
                                                [hideSelected]="true"
                                                [(ngModel)]="tagged_conversation_users" 
                                                placeholder="Select people to start a conversation with...">
                                                <ng-template ng-label-tmp let-item="item" let-clear="clear">
                                                    <span class="ng-value-label">
                                                        <span *ngIf="!item.staticDpImg" class="multiple-select-user-name uppercase" >{{(item.name ? item.name : item.sort_type) | slice:0:1}}</span>
                                                        <img *ngIf="item.staticDpImg" [src]="item.staticDpImg" (error)="updateDefaultImageUrl($event)" class="multiple-select-user-img">&nbsp;&nbsp;{{item.name ? item.name : item.sort_type }}
                                                    </span>
                                                    <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">Ã—</span>
                                                </ng-template>
                                                <ng-template ng-option-tmp let-item="item">
                                                    <div *ngIf="!item.staticDpImg" class="user-name-dropdown-conversation uppercase">{{(item.name ? item.name : item.sort_type ) | slice:0:1}}</div>
                                                    <img *ngIf="item.staticDpImg" [src]="item.staticDpImg" (error)="updateDefaultImageUrl($event)" class="multiple-select-user-dropdown-img">&nbsp;&nbsp;{{item.name ? item.name : item.sort_type}}
                                                </ng-template>
                                            </ng-select>
                                        </div>
                                        <textarea class="conversation-textarea" id="conversion_text_element" placeholder="Ask questions,share feedback etc.." (keyup)="enablePostConversationButton()" (change)="enablePostConversationButton()" (paste)="enablePostConversationButton()" ></textarea>
                                    </div>
                                    <div class="comment-section">
                                        <ng-container *ngFor="let conversation_multiple_file of conversation_multiple_file_array">
                                            <!-------------------- audio file uploading ---------------------->
                                            <div class="audio-file" *ngIf="conversation_multiple_file.type=='audio_file'">
                                                <a class="pull-right remove-color" title="Delete" *ngIf="conversation_multiple_file.relative_path && conversation_multiple_file.upload_type" (click)="delConversationDocType(conversation_multiple_file.type,conversation_multiple_file.relative_path)"><i class="fa fa fa-remove"></i></a>
                                                {{conversation_multiple_file.file_name}}
                                            </div>
                                            <!--------------------- audio file uploading ------------------------------->
                                        </ng-container>
                                        <ng-container *ngFor="let conversation_multiple_file of conversation_multiple_file_array">
                                            <!--------------------------------------upload images ------------------>
                                            <div class="thumbnail-list" *ngIf="conversation_multiple_file.type=='image_file'">
                                                <a class="remove-upload-icon" title="Delete" *ngIf="conversation_multiple_file.relative_path && conversation_multiple_file.upload_type" (click)="delConversationDocType(conversation_multiple_file.type,conversation_multiple_file.relative_path)"><i class="fa fa fa-remove"></i></a>
                                                <img alt="" [src]="conversation_multiple_file.image_src">
                                            </div>
                                            <!--------------------------------------upload images end------------------>
                                        </ng-container>
                                        <div class="btn-container" style="border-top:1px solid #ccc;">
                                            <div class="upload-btn-container" style="position: relative;">
                                                <a class="btn gray-text" style="position: relative;"  (click)="uploadConversationDocType('image')" title="Upload an image">
                                                    <i class="fa fa-camera"></i>
                                                </a>
                                                <a class="btn gray-text" style="position: relative;" (click)="uploadConversationDocType('audio')" title="Upload an audio file(Mp3,WAV)">
                                                    <i class="fa fa-microphone"></i>
                                                </a>
                                                <!-- <a class="btn gray-text" style="position: relative;" (click)="showConversationEmoji()" title="Add Emoji">
                                                    <i class="fa fa-smile-o"></i>
                                                </a> -->
                                                <button class="pull-right btn-blue-color" id="default_conversation_post_button" [attr.disabled] = "conversation_post_button ? 'disabled' : null" [ngStyle]="{'background': conversation_post_button ? '' : '#337ab7','color' : conversation_post_button ? '' : '#ffffff'}" (click)="postConversationStory()" title="Post"> Post </button>
                                            </div>
                                            <emoji-mart class="emoji-adjust" id="emoji_conversation_type_story" *ngIf="conversation_emojiStatus" (emojiClick)="addConversationEmoji($event)"></emoji-mart>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!------------------------- Conversation part end -------------------------->

            <!-------------------------- published story part --------------------------->
            <div class="row" id="activity_card"> 
                <!--
                |-----------------------------------------------------------
                |activity card start
                |-------------------------------------------------------------
                --> 
                <div class="dasboard-stories-card" *ngFor="let stories of mutiple_stories_array; let count=index;">
                    <div class="custom-profile-image">
                        <span *ngIf="stories.staticDpImg"><img [src]="stories.staticDpImg" (error)="updateDefaultImageUrl($event)" class="img-circle" /></span>
                        <div class="custom-profile-image-text uppercase" *ngIf="!stories.staticDpImg">{{stories?.createrFirstName | slice:0:1}}{{stories?.createrLastName | slice:0:1}}</div>
                    </div>
                    <div class="stories-card">
                            <div class="col-sm-12 well main-form">
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="card-header-tag">
                                            <div class="flex-content" style="margin-bottom:5px;">
                                                <span class="sub-head">
                                                    <a style="text-decoration: none;" [innerHTML]="stories.icon_type"></a>
                                                    <span style="font-size:15px;"> 
                                                        <i [ngClass]="stories.public? 'fa fa-globe' : 'fa fa-lock'" aria-hidden="true" style="margin-right: 2px;"></i>{{stories.public == true ? 'PUBLIC EVENT' : 'PRIVATE EVENT'}}
                                                    </span>
                                                    <span style="padding-left:5px;font-size:14px;color:#4E5A67;" > 
                                                        {{"Created by " +(stories?.createrFirstName ? stories?.createrFirstName : '')+" "+(stories?.createrLastName ? stories?.createrLastName : '') | slice:0:100}}
                                                        <!-- {{school_details.school_name ? school_details.school_name : '' }}  -->
                                                    </span>
                                                </span>
                                                <!-- <span class="dropdown" style="cursor: pointer;">
                                                    <a data-toggle="dropdown" class="dropdown-toggle"><b class="caret" style="border-width:8px;"></b></a>
                                                    <ul class="dropdown-menu dropdown-menu-right">
                                                        <li><a>Print preview</a></li>
                                                        <li><a>Remove</a></li>
                                                    </ul>   
                                                </span> -->
                                            </div>
                                        </div>
                                        <a [routerLink]="('/activity/preview/')+stories.id" style="text-decoration: none;" title="{{stories?.caption_plain}}">
                                            <div class="title-story" [innerHTML]="stories?.caption_plain" style="word-break: break-all;">
                                                <!-- Storytwinkle created the story -->
                                            </div>
                                        </a>
                                    </div>
                                </div>
                                <a [routerLink]="('/activity/preview/')+stories.id" title="{{stories?.caption_plain}}">
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div *ngFor="let images of stories.image_array;let x=index;">
                                            <!------------------------------------ SINGLE IMAGE GALLERY --------------------------------------->
                                            <div class="img-container" *ngIf="stories.image_array?.length==1 && x==0">
                                                <img src="{{images.image_src}}">
                                            </div>
                                            <!------------------------------------ SINGLE IMAGE GALLERY END--------------------------------------->
                                            <!------------------------------------ TWO IMAGE GALLERY --------------------------------------->
                                            <div class="img-container2" *ngIf="stories.image_array?.length==2 && x==1">
                                                <div class="leftcolumn">
                                                    <img src="{{stories.image_array[x-1].image_src}}">
                                                </div>
                                                <div class="rightcolumn">
                                                    <!-- <img src="{{images.image_src}}"> -->
                                                    <img src="{{stories.image_array[x].image_src}}">
                                                </div>
                                            </div>
                                            <!------------------------------------ TWO IMAGE GALLERY END--------------------------------------->
                                            <!------------------------------------ THREE IMAGE GALLERY --------------------------------------->
                                            <div class="img-container41" *ngIf="stories.image_array?.length==3 && x==2">
                                                <div class="left_content_images1">
                                                    <img src="{{stories.image_array[x-2].image_src}}">
                                                </div>
                                                <div class="right_content_images">
                                                    <div class="rightcolumn1">
                                                        <img src="{{stories.image_array[x-1].image_src}}">
                                                    </div>
                                                    <div class="rightcolumn2">
                                                        <img src="{{stories.image_array[x].image_src}}">
                                                    </div>
                                                </div>
                                            </div>
                                            <!------------------------------------ THREE IMAGE GALLERY END--------------------------------------->
                                            <!------------------------------------ FOUR IMAGE GALLERY --------------------------------------->
                                            <div class="img-container41" *ngIf="stories.image_array?.length>=4 && x==3">
                                                <div class="left_content_images">
                                                    <div class="leftcolumn1">
                                                        <img src="{{stories.image_array[x-3].image_src}}">
                                                    </div>
                                                    <div class="leftcolumn2">
                                                        <img src="{{stories.image_array[x-1].image_src}}">
                                                    </div>
                                                </div>
                                                <div class="right_content_images">
                                                    <div class="rightcolumn1">
                                                        <img src="{{stories.image_array[x-2].image_src}}">
                                                    </div>
                                                    <div class="rightcolumn2">
                                                        <img src="{{stories.image_array[x].image_src}}">
                                                    </div>
                                                </div>
                                            </div>
                                            <!------------------------------------ FOUR IMAGE GALLERY END--------------------------------------->
                                        </div>
                                        <!------------------------------------ video GALLERY --------------------------------------->
                                        <ng-container *ngIf="stories.image_array?.length==0">
                                            <ng-container *ngFor="let video of stories.video_array;let x=index;">
                                                <div class="img-container" *ngIf="x==0">
                                                    <video controls><source src="{{video.video_src}}" type="video/mp4"></video>
                                                </div>
                                            </ng-container>
                                        </ng-container>
                                        <!------------------------------------ video GALLERY END--------------------------------------->
                                    </div>
                                </div>
                                </a>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="story-content-paragraph">
                                            <p class="post-story-time" *ngIf="stories?.updatedAt"> Posted on <em> {{stories?.updatedAt | date:'medium'}} </em></p>
                                            <!-- <div *ngFor="let text of stories.text_array;let x=index;" >
                                                <p class="description-content" [ngStyle]="{'font-size':'16px'}" *ngIf="x==0" [innerHTML]="text?.text_data"></p>
                                            </div> -->
                                            <p [ngStyle]="{'font-size':'16px','word-break':'break-all'}" [innerHTML]="stories.textContent" ></p>
                                            <a style="cursor:pointer;" [routerLink]="('/activity/preview/')+stories.id" >Click here for more details...</a>
                                            <br>
                                            <!---------------------------------download link ---------------------------->
                                            <div *ngFor="let pdf of stories.pdf_array;let x=index;">
                                                <div class="flex-content pdf-content" *ngIf="x==0">
                                                    <a [href]="pdf.pdf_src" class="pdf-text-download-view" target="_blank" title="View file">Document.pdf</a><span class="download-icon" (click)="downloadFile(pdf.pdf_src)" title="download file" ><i class="fa fa-download" aria-hidden="true"></i></span>
                                                </div>
                                            </div>
                                            <!---------------------------------download link end---------------------------->
                                        </div>
                                    </div>
                                </div>

                                <div class="row" id="comment_section_div_{{stories?.id}}">
                                    <div class="col-sm-12">
                                        <span class="cursor-pointer pull-left" style="padding-left:10px;" id="show_count_comments_parent_div_{{stories.id}}" *ngIf="stories?.comment_array?.length > 0"> Total Comments: {{stories.comment_array.length}} </span>
                                        <span class="cursor-pointer pull-right" id="show_more_comments_parent_div_{{stories.id}}" *ngIf="stories.comment_array?.length>2" (click)="showHideComment('show',stories.id,'parent')" style="padding-right:10px;"><b>Show previous comments</b></span>
                                        <br>
                                        <div class="comment-section">
                                            <!-- <div class="row">
                                                <div class="col-sm-12">
                                                    <Label style="font-size:18px;"> Select display comments </Label>   
                                                </div>
                                                <div class="col-sm-12">
                                                    <div style="border-bottom:1px solid #e58a25;padding-bottom: 5px;">
                                                        <label class="radio-inline" style="font-size: 16px; line-height: 1.6">
                                                            <input type="radio" #displayComments style="margin-top: 0.3em; width: 1em; height: 1em;" name="{{ 'commentTypes' + count }}"
                                                                value="public" [checked]="true"> Public
                                                        </label>
                                                        <label class="radio-inline" style="font-size: 16px; line-height: 1.6">
                                                            <input type="radio" style="margin-top: 0.3em; width: 1em; height: 1em;" name="{{ 'commentTypes' + count }}"
                                                                value="private" [checked]="false"> Private
                                                        </label> 
                                                    </div>
                                                </div>
                                            </div> -->
                                            <ng-container *ngFor="let comment of stories.comment_array;let index_value=index;">
                                                <!-------------------- chat list routing  Preview ------------------------>
                                                <ng-container *ngIf="index_value >= stories.comment_display_count">
                                                    <div class="col-sm-12 chating-list" [id]="'comment_display_main_div_'+comment.result.id">
                                                        <div class="row">
                                                            <span *ngIf="comment.result.delete_status" class="pull-right remove-icon-chat" title="Remove" (click)="showDeleteCommentPopup(stories.id,comment.result.id,'parent',0,comment)"><i class="fa fa-remove"></i></span>
                                                            <div class="custom-profile-image-chat">
                                                                <span *ngIf="comment?.result?.staticDpImg"><img [src]="comment.result.staticDpImg" (error)="updateDefaultImageUrl($event)" class="img-circle-chat" /></span>
                                                                <div *ngIf="!comment?.result?.staticDpImg" class="custom-profile-image-text-chat uppercase"> {{ comment.result.user.email ? ( comment.result.user.email | slice:0:1) : '' ? comment.result.user.email : ''}}  </div>
                                                            </div>
                                                            <div class="stories-chat-list">
                                                                <div style="font-weight:600;margin-bottom:10px;">
                                                                    {{ comment.result.user.userProfile.firstName ? comment.result.user.userProfile.firstName : '' }}
                                                                </div>
                                                                <ng-container *ngFor="let comment_type of comment.comment_details">
                                                                    <!---------------- text display ---------------------->
                                                                    <p *ngIf="comment_type.type=='text_file'" [innerHTML]="comment_type.text_data"></p>
                                                                    <!---------------- text display end---------------------->
                                                                </ng-container>    
                                                                <!---------------------- images preview ------------------->
                                                                <ng-container *ngFor="let comment_type of comment.comment_details">
                                                                    <span class="people-list-grid" *ngIf="comment_type.type=='image_file'">
                                                                        <span class="landscape thumb-container">
                                                                            <img (click)="openImageModal(comment.comment_details,comment_type.image_src)" [src]="comment_type.image_src">
                                                                        </span>
                                                                    </span>
                                                                </ng-container>
                                                                <!---------------------- images preview end ------------------->
                                                                    
                                                                <!---------------------- Audio file ------------------->
                                                                <ng-container *ngFor="let comment_type of comment.comment_details">
                                                                    <audio *ngIf="comment_type.type=='audio_file'" controls [src]="comment_type.audio_src"></audio>
                                                                </ng-container>
                                                                <!---------------------- Audio file end ------------------->
                                                                <div class="replay-text">
                                                                    <label><a style="cursor: pointer;font-size:15px;color:#e58a25;" *ngIf="comment?.result?.replyButtonStatus" (click)="showReplyComment(stories.id,comment.result.id)" title="Reply Comment"> Reply </a></label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-------------------- replay story chating child comments start---------------------->
                                                        <div class="row" style="padding-left: 40px;" id="child_reply_comment_div_{{comment.result.id}}">
                                                            <ng-container *ngIf="comment.child_comment_array?.length>2">
                                                                    <span class="cursor-pointer" id="show_more_comments_child_div_{{stories.id}}_{{comment.result.id}}" (click)="showHideComment('show',stories.id,'child',comment.result.id)"><b>Show previous comments</b></span>
                                                            </ng-container>
                                                            <ng-container *ngIf="comment.child_comment_array?.length>0">
                                                                <ng-container *ngFor="let child_comment of comment.child_comment_array;let child_index=index;">
                                                                    <ng-container *ngIf="child_index >= comment.child_comment_display_count">
                                                                        <div id="child_comment_display_main_div_{{child_comment.result.id}}">
                                                                            <span *ngIf="child_comment.result.delete_status" class="pull-right remove-icon-chat" title="Remove" (click)="showDeleteCommentPopup(stories.id,comment.result.id,'child',child_comment.result.id,child_comment)"><i class="fa fa-remove"></i></span>
                                                                            <div class="custom-profile-image-chat">
                                                                                <span *ngIf="child_comment?.result?.staticDpImg"><img [src]="child_comment.result.staticDpImg" (error)="updateDefaultImageUrl($event)" class="img-circle-chat" /></span>
                                                                                <div *ngIf="!child_comment?.result?.staticDpImg" class="custom-profile-image-text-chat uppercase"> {{ child_comment.result.user.email ? ( child_comment.result.user.email | slice:0:1) : '' ? child_comment.result.user.email : ''}} </div>
                                                                            </div>
                                                                            <div class="stories-chat-list">
                                                                                <div style="font-weight:600;margin-bottom:10px;">
                                                                                    {{ child_comment.result.user.email ? (child_comment.result.user.email | slice:0:(child_comment.result.user.email.lastIndexOf("@"))) : ''}}  <em class="small">{{ child_comment.result.updatedAt | timeAgo | async }}</em> 
                                                                                </div>
                                                                                <ng-container *ngFor="let comment_type of child_comment.comment_details">
                                                                                    <!---------------- text display ---------------------->
                                                                                    <p *ngIf="comment_type.type=='text_file'" [innerHTML]="comment_type.text_data"></p>
                                                                                    <!---------------- text display end---------------------->
                                                                                </ng-container>    
                                                                                <!---------------------- images preview ------------------->
                                                                                <ng-container *ngFor="let comment_type of child_comment.comment_details">
                                                                                    <span class="people-list-grid" *ngIf="comment_type.type=='image_file'">
                                                                                        <span class="landscape thumb-container">
                                                                                            <img  (click)="openImageModal(child_comment.comment_details,comment_type.image_src)" [src]="comment_type.image_src">
                                                                                        </span>
                                                                                    </span>
                                                                                </ng-container>
                                                                                <!---------------------- images preview end ------------------->
                                                                                    
                                                                                <!---------------------- Audio file ------------------->
                                                                                <ng-container *ngFor="let comment_type of child_comment.comment_details">
                                                                                    <audio *ngIf="comment_type.type=='audio_file'" controls [src]="comment_type.audio_src"></audio>
                                                                                </ng-container>
                                                                                <!---------------------- Audio file end ------------------->
                                                                            </div>
                                                                        </div>
                                                                    </ng-container>
                                                                </ng-container>
                                                            </ng-container>
            
                                                            <!------------------- Reply type comment textarea end -------------------->
                                                            <div id="reply_comment_div_{{comment.id}}" *ngIf="!comment.result.replyButtonStatus">
                                                                    <span  class="pull-right remove-icon-chat" title="Remove" (click)="closeChildReplyCommentBox(stories.id,comment.id,'delete')"><i class="fa fa-remove"></i></span> 
                                                                <!------------------------------------ textarea ------------------------->
                                                                <div class="typecomment" id="child_comment_text_div_{{comment.id}}">
                                                                    <textarea class="chating-textarea" (focus)="focusAdd('child_comment_text_'+comment.id)" (focusout)="focusRemove('child_comment_text_'+comment.id)" (keyup)="showPostButton(stories.id,'child',comment.id)" (change)="showPostButton(stories.id,'child',comment.id)" (paste)="showPostButton(stories.id,'child',comment.id)" rows="1" cols="10" placeholder="Write a comment..." id="child_comment_text_{{comment.id}}"></textarea>
                                                                    <span class="error-mez" id="child_comment_text_{{comment.id}}_error"></span>
                                                                </div>
                                                                <!------------------------------------ textarea end------------------------->
                                                                <ng-container *ngFor="let comment_multiple_file of comment_multiple_file_array">
                                                                    <!-------------------- audio file uploading ---------------------->
                                                                    <div class="audio-file" *ngIf="comment_multiple_file.type=='audio_file' && comment_multiple_file.story_id==stories.id && comment_multiple_file.comment_type=='child' && comment_multiple_file.comment_id==comment.id">
                                                                        <a class="pull-right remove-color" title="Delete" (click)="delDocType(omment_multiple_file.type,stories.id,'child',comment.id,comment_multiple_file.relative_path)"><i class="fa fa fa-remove"></i></a>
                                                                        {{comment_multiple_file.file_name}}
                                                                    </div>
                                                                    <!--------------------- audio file uploading ------------------------------->
                                                                </ng-container>
                                                                <ng-container *ngFor="let comment_multiple_file of comment_multiple_file_array">
                                                                    <!--------------------------------------upload images ------------------>
                                                                    <div class="thumbnail-list" *ngIf="comment_multiple_file.type=='image_file' && comment_multiple_file.story_id==stories.id && comment_multiple_file.comment_type=='child' && comment_multiple_file.comment_id==comment.id">
                                                                        <a class="remove-upload-icon" title="Delete" (click)="delDocType(comment_multiple_file.type,stories.id,'child',comment.id,comment_multiple_file.relative_path)"><i class="fa fa fa-remove"></i></a>
                                                                        <img alt="" [src]="comment_multiple_file.image_src">
                                                                    </div>
                                                                    <!--------------------------------------upload images end------------------>
                                                                </ng-container>
                                                        
                                                                <!-------------------------------- post area ---------------------------------------->
                                                                <div class="btn-container" id="post_child_comment_div_{{comment.id}}">
                                                                    <div class="upload-btn-container" style="position: relative;">
                                                                        <div class="btn chating-user">
                                                                            <ng-container *ngFor="let user of user_child_detail_array">
                                                                                <ng-container *ngIf="user.isChecked">
                                                                                    <img *ngIf="user.staticDpImg" [src]="user.staticDpImg" class="profile-image" (error)="updateDefaultImageUrl($event)"/>
                                                                                    <label *ngIf="!user.staticDpImg" class="profile-name-navbar uppercase" > {{ userProfilename ? (userProfilename | slice:0:1) : ''}} </label>
                                                                                    <span class="comment-name-responsive" >&nbsp;&nbsp; {{ userProfilename }}</span>
                                                                                </ng-container>
                                                                            </ng-container>
                                                                        </div>
                                                                        <!---------------- child or user select ----------->
                                                                        <!-- <ul class="select-author" id="child_comment_behalf_child_user_dropdown_{{comment.id}}"  *ngIf="user_child_detail_array?.length>0" style="display:none">
                                                                            <li *ngFor="let user of user_child_detail_array" (click)="selectCommentByUser(user.id,user.user_type, 'child_comment_behalf_child_user_dropdown_'+comment.id)">
                                                                                <img *ngIf="user.staticDpImg" [src]="user.staticDpImg" class="profile-image" (error)="updateDefaultImageUrl($event)"/>
                                                                                <label *ngIf="!user.staticDpImg" class="profile-name-navbar uppercase" >{{user.firstName | slice:0:1}}{{user.lastName | slice:0:1}}</label>
                                                                                &nbsp;&nbsp; {{user.firstName ? user.firstName : ''}}
                                                                            </li>
                                                                        </ul> -->
                                                                        <!---------------- child or user select end----------->
                                                                    
                                                                        <a class="btn gray-text" style="position: relative;" (click)="uploadDocType(stories?.id,'image', 'child',comment.id)" title="Upload an image">
                                                                            <i class="fa fa-camera"></i>
                                                                        </a>
                                                                        <a class="btn gray-text" style="position: relative;" (click)="uploadDocType(stories?.id,'audio', 'child',comment.id)"  title="Upload an audio file(Mp3,WAV)">
                                                                            <i class="fa fa-microphone"></i>
                                                                        </a>
                                                                        <!-- <a class="btn gray-text" style="position: relative;" (click)="showEmoji(stories.id,'child',comment.id)" title="Add Emoji">
                                                                            <i class="fa fa-smile-o"></i>
                                                                        </a> -->
                                                                        <button class="pull-right btn-blue-color" id="comment_post_button_{{stories.id}}_{{comment.id}}" [attr.disabled] = "comment?.result?.disabledChildCommentReply ? 'disabled' : null" [ngStyle]="{'background': comment?.result?.disabledChildCommentReply ? '' : '#337ab7','color' : comment?.result?.disabledChildCommentReply ? '' : '#ffffff'}" (click)="postChildComment(stories.id,comment.id,count)" title="Reply"> <i class="fa fa-paper-plane-o"></i> </button>
                                                                    </div>
                                                                    <emoji-mart class="emoji-adjust" id="emoji_child_{{stories.id}}_{{comment.id}}" *ngIf="comment?.result?.emojiStatus" (emojiClick)="addEmoji($event,stories.id,'child',comment.id)"></emoji-mart>
                                                                </div>
                                                                <br>
                                                                <!-------------------------------- post area end---------------------------------------->
                                                            </div>
                                                            <!------------------- Reply type comment textarea end -------------------->
                                                        </div>
                                                            <!-------------------- reply story chating end---------------------->
                                                        </div>
                                                    </ng-container>
                                            </ng-container>
                                            <!-------------------- chat list routing Preview end ------------------------>
                                            <!------------------------------------ textarea ------------------------->
                                            <div class="typecomment" id="comment_text_div_{{stories.id}}">
                                                <textarea class="chating-textarea" (focus)="focusAdd('comment_text_'+stories.id)" (focusout)="focusRemove('comment_text_'+stories.id)" (keyup)="showPostButton(stories.id,'parent',0)" rows="1" cols="10" placeholder="Write a comment..." id="comment_text_{{stories.id}}"></textarea>
                                                <span class="error-mez" id="comment_text_{{stories.id}}_error"></span>
                                            </div>
                                            <!------------------------------------ textarea end------------------------->
                                            <ng-container *ngFor="let comment_multiple_file of comment_multiple_file_array">
                                                <!-------------------- audio file uploading ---------------------->
                                                <div class="audio-file" *ngIf="comment_multiple_file.type=='audio_file' && comment_multiple_file.story_id==stories.id && comment_multiple_file.comment_type=='parent'">
                                                    <a class="pull-right remove-color" title="Delete" (click)="delDocType(comment_multiple_file.type,stories.id,'parent',0,comment_multiple_file.relative_path)"><i class="fa fa fa-remove"></i></a>
                                                    {{comment_multiple_file.file_name}}
                                                </div>
                                                <!--------------------- audio file uploading ------------------------------->
                                            </ng-container>
                                            <ng-container  *ngFor="let comment_multiple_file of comment_multiple_file_array">
                                                <!--------------------------------------upload images ------------------>
                                                <div class="thumbnail-list" *ngIf="comment_multiple_file.type=='image_file' && comment_multiple_file.story_id==stories.id && comment_multiple_file.comment_type=='parent'">
                                                    <a class="remove-upload-icon" title="Delete" (click)="delDocType(comment_multiple_file.type,stories.id,'parent',0,comment_multiple_file.relative_path)"><i class="fa fa fa-remove"></i></a>
                                                    <img alt="" [src]="comment_multiple_file.image_src">
                                                </div>
                                                <!--------------------------------------upload images end------------------>
                                            </ng-container>
                                            <!-------------------------------- post area ---------------------------------------->
                                            <div class="btn-container" id="post_comment_div_{{stories.id}}">
                                                <div class="upload-btn-container" style="position: relative;">
                                                    <div class="btn chating-user">
                                                        <ng-container *ngFor="let user of user_child_detail_array">
                                                            <ng-container *ngIf="user.isChecked">
                                                                <img *ngIf="user.staticDpImg" [src]="user.staticDpImg" class="profile-image" (error)="updateDefaultImageUrl($event)"/>
                                                                <label *ngIf="!user.staticDpImg" class="profile-name-navbar uppercase" > {{ userProfilename ? (userProfilename | slice:0:1) : ''}} </label>
                                                                <span class="comment-name-responsive"> &nbsp;&nbsp;{{ userProfilename }} </span>
                                                            </ng-container>
                                                        </ng-container>
                                                    </div>
                                                    <!---------------- child or user select ----------->
                                                    <!-- <ul class="select-author" *ngIf="user_child_detail_array?.length>0" id="comment_behalf_user_dropdown_{{stories.id}}" style="display:none">
                                                        <li *ngFor="let user of user_child_detail_array" (click)="selectCommentByUser(user.id,user.user_type,'comment_behalf_user_dropdown_'+stories.id)">
                                                            <img *ngIf="user.staticDpImg" [src]="user.staticDpImg" class="profile-image" (error)="updateDefaultImageUrl($event)"/>
                                                            <label *ngIf="!user.staticDpImg" class="profile-name-navbar uppercase" >{{user.firstName | slice:0:1}}{{user.lastName | slice:0:1}}</label>
                                                            &nbsp;&nbsp; {{user.firstName ? user.firstName : ''}}
                                                        </li>
                                                    </ul> -->
                                                    <!---------------- child or user select end----------->

                                                    <a class="btn gray-text" style="position: relative;" (click)="uploadDocType(stories?.id,'image', 'parent')" title="Upload an image">
                                                        <i class="fa fa-camera"></i>
                                                    </a>
                                                    <a class="btn gray-text" style="position: relative;" (click)="uploadDocType(stories?.id,'audio','parent')"  title="Upload an audio file(Mp3,WAV)">
                                                        <i class="fa fa-file-audio-o"></i>
                                                    </a>
                                                    <a style="position: relative;text-decoration: none;" *ngIf=normalUser>
                                                        <label>
                                                            <input type="checkbox" class="toggle" [(ngModel)]="theCheckbox" (change)="toggleVisibility($event)">
                                                            <span *ngIf="marked"> Private </span><span *ngIf="!marked"> Public </span>
                                                        </label>
                                                    </a>
                                                    <!-- <a class="btn gray-text" style="position: relative;" (click)="showEmoji(stories.id,'parent')" title="Add Emoji" >
                                                        <i class="fa fa-smile-o"></i>
                                                    </a> -->
                                                    <button class="pull-right" id="comment_post_button_{{stories.id}}" [attr.disabled] = "stories?.disabledCommentPost ? 'disabled' : null" [ngStyle]="{'background': stories?.disabledCommentPost ? '' : '#337ab7','color': stories?.disabledCommentPost ? '' : '#ffffff'}" (click)="postComment(stories.id,count)"  title="Post"> Post </button>
                                                </div>
                                                <emoji-mart class="emoji-adjust" id="emoji_parent_{{stories.id}}" *ngIf="stories.emojiStatus" (emojiClick)="addEmoji($event,stories.id,'parent')" > </emoji-mart>
                                            </div>
                                            <!-------------------------------- post area end---------------------------------------->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 text-center">
                                  <div *ngIf="loadingStories" class="simple-loader"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!------------------------- Published story part end ------------------------->
                
                <!----------------------------- content loader gif image -------------------------->
                <!-- <div class="row">
                    <div class="col-sm-12" style="text-align: center;font-size:16px;">
                        <span class="loading-more"><img src="assets/images/small-loader.gif"><i> loading more... </i></span>
                    </div>
                </div> -->
                <!----------------------------- content loader gif image end-------------------------->

                
            </div>
            <!---------------------- Default stories storytwinkle end----------------------->
            <!--
            |-----------------------------------------------------------
            |activity card end
            |-------------------------------------------------------------
            --> 
        </div>
    </div>
<!-----------------------------------Delete Confirmation popup start-------------------------->
<div class="modal fade" role="dialog" id="delete_comment_modal" >
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
        <div class="modal-body">
            <div class="row">
            <div class="col-sm-12">
                <p style="font-size:16px;color:#333"> Are you sure you want to delete this comment? This action cannot be undone. </p>
            </div>
            </div>
        </div>
        <div class="modal-footer">
            <input type="button" class="btn custom-btn-close" data-dismiss="modal" value="No" >
            <input type="button" value="post" class="btn custom-btn" (click)="deleteComment()" value="Yes">
        </div>
        </div>
    </div>
</div>
      <!-----------------------------------Delete Confirmation popup end------------------------------->

<div #story_content style="display:none" aria-hidden="true"></div>
<div #story_description_content style="display:none" aria-hidden="true"></div> 
<div #story_comment_content style="display:none" aria-hidden="true"></div>
<input type="file" style="display:none;" id="main_file" accept=".jpg,.png,.jpeg" />

<input type="file" style="display:none;" multiple id="main_check_file" accept=".jpg,.png,.jpeg" (change)="fileChanged($event)" #fileInput/>

<ks-modal-gallery [id]="1" [modalImages]="modal_images"></ks-modal-gallery>

<div #story_header_content id="story_header_content" style="display:none"></div>